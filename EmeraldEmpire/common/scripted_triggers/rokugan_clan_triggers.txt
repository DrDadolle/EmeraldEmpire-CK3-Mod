######################
# Major/Minor Clan Definition
######################
# Function to know when someone is under the emperor's reign
is_under_e_rokugan_rule = {
    AND = {
        is_independent_ruler = no
        #top liege is rokugani emperor
        top_liege = { primary_title = title:e_rokugan }
    }
}

# Function to know when someone is the emperor direct vassal
is_under_direct_e_rokugan_rule = {
    AND = {
        is_independent_ruler = no
        #liege is rokugani emperor
        liege = { primary_title = title:e_rokugan }
    }
}

# Is from samurai culture
is_from_samurai_culture = {
        culture = { has_cultural_tradition = tradition_bushido }
}

# Hardcoded culture list
is_from_rokugani_culture = {
    OR = {
        culture = { has_cultural_pillar = heritage_crane }
        culture = { has_cultural_pillar = heritage_lion }
        culture = { has_cultural_pillar = heritage_phoenix }
        culture = { has_cultural_pillar = heritage_dragon }
        culture = { has_cultural_pillar = heritage_scorpion }
        culture = { has_cultural_pillar = heritage_crab }
        culture = { has_cultural_pillar = heritage_unicorn }
        culture = { has_cultural_pillar = heritage_imperial }
        culture = { has_cultural_pillar = heritage_kitsune }
        culture = { has_cultural_pillar = heritage_kasuga }
        culture = { has_cultural_pillar = heritage_tonbo }
        culture = { has_cultural_pillar = heritage_toritaka }
        culture = { has_cultural_pillar = heritage_usagi }
        culture = { has_cultural_pillar = heritage_yoritomo }
        culture = { has_cultural_pillar = heritage_tsuruchi }
        culture = { has_cultural_pillar = heritage_suzume }
        culture = { has_cultural_pillar = heritage_ichiro }
        culture = { has_cultural_pillar = heritage_nekoma }
        culture = { has_cultural_pillar = heritage_komori }
        culture = { has_cultural_pillar = heritage_shika }
        culture = { has_cultural_pillar = heritage_kaikoga }
        culture = { has_cultural_pillar = heritage_chuda }
        culture = { has_cultural_pillar = heritage_kuma }
        culture = { has_cultural_pillar = heritage_kaeru }
    }
}

# Hard-coded for now. Maybe it'll be a special flag on a title later ?
is_imperial_family = {
    OR = {
        dynasty = dynasty:dynasty_hantei #Hantei
        dynasty = dynasty:dynasty_otomo #Otomo
        dynasty = dynasty:dynasty_seppun #Seppun
        dynasty = dynasty:dynasty_miya # Miya
    }
}

# One of the lieges should be a pure king. And is Feudal
is_major_clan = {
    is_independent_ruler = no
    OR = {
        any_liege_or_above = {
            government_has_flag = government_is_feudal
            highest_held_title_tier = tier_kingdom
            # and is human & and is rokugani
        }
        AND = {
            government_has_flag = government_is_feudal
            highest_held_title_tier = tier_kingdom
            # and is human & and is rokugani
        }
    }
}

# All liege above dont have a highest held title a kingdom. And is Feudal.
is_minor_clan = {
    is_independent_ruler = no
    AND = {
        government_has_flag = government_is_feudal
        liege = {
            government_has_flag = government_is_feudal
            NOT = {
                highest_held_title_tier = tier_kingdom
                # and is human & and is rokugani
            }
            liege = {
                government_has_flag = government_is_feudal
                NOT = {
                    highest_held_title_tier = tier_kingdom
                    # and is human & and is rokugani
                }
            }
        }
        NOT = {
             highest_held_title_tier = tier_kingdom

             # and is human & and is rokugani
        }
    }
}


######################
# Clan Definition
######################
# Crane clan detector
is_under_k_crane_clan_rule_or_is_ruler = {
    AND = {
        is_under_e_rokugan_rule = yes
        #any_liege is crane clan
        OR = {
            any_liege_or_above = { primary_title = title:k_crane_clan }
            primary_title = title:k_crane_clan
        }
    }
}

# Lion clan detector
is_under_k_lion_clan_rule_or_is_ruler = {
    AND = {
        is_under_e_rokugan_rule = yes
        #any_liege is lion clan
        OR = {
            any_liege_or_above = { primary_title = title:k_lion_clan }
            primary_title = title:k_lion_clan
        }
    }
}

# Unicorn clan detector
is_under_k_unicorn_clan_rule_or_is_ruler = {
    AND = {
        is_under_e_rokugan_rule = yes
        #any_liege is unicorn clan
        OR = {
            any_liege_or_above = { primary_title = title:k_unicorn_clan }
            primary_title = title:k_unicorn_clan
        }
    }
}
